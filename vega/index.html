<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting up your system &mdash; Heterogeneous programming with SYCL  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_lesson.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_rtd_theme_ext_color_contrast.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/minipres.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script data-domain="enccs.github.io/sycl-workshop" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Heterogeneous programming with SYCL
              <img src="../_static/ENCCS.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../karolina/">Setting up your system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The lesson</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../what-is-sycl/">What is SYCL?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../device-discovery/">Device discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../queues-cgs-kernels/">Queues, command groups, and kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../buffers-accessors/">Data management with buffers and accessors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unified-shared-memory/">Data management with unified shared memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../expressing-parallelism-basic/">Expressing parallelism with SYCL: basic data-parallel kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../expressing-parallelism-nd-range/">Expressing parallelism with SYCL: nd-range data-parallel kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task-graphs-synchronization/">The task graph: data, dependencies, synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../heat-equation/">Heat equation mini-app</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sub-groups/">Using sub-groups in SYCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../profiling/">Profiling SYCL applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../buffer-accessor-vs-usm/">Buffer-accessor model <em>vs</em> unified shared memory</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zbibliography/">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/">Instructor’s guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Heterogeneous programming with SYCL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setting up your system</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ENCCS/sycl-workshop/blob/main/content/vega.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setting-up-your-system">
<h1>Setting up your system<a class="headerlink" href="#setting-up-your-system" title="Permalink to this heading"></a></h1>
<p>Thanks to <a class="reference external" href="https://www.izum.si/en/home/">IZUM</a>, we will have an allocation on the Vega supercomputer for the
whole duration of the workshop.
The required software stack is already installed and available through the
module system on the supercomputer.</p>
<p>If you prefer to install the required software locally, we refer you to the
<a class="reference external" href="https://github.com/illuhad/hipSYCL/tree/develop/install/scripts#readme">official hipSYCL installation instructions</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Your mileage may vary with a local installation: building some of the
dependencies is an <em>extremely</em> time consuming process.  We will <strong>not</strong>
provide support for local installations during the workshop.</p>
</div>
<section id="how-to-follow-along">
<h2>How to follow along<a class="headerlink" href="#how-to-follow-along" title="Permalink to this heading"></a></h2>
<p>This training material, including all exercises and solutions, is available on
<a class="reference external" href="https://github.com/ENCCS/sycl-workshop">GitHub</a>.  To get the most out of it,
we suggest that you clone it locally:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ENCCS/sycl-workshop
</pre></div>
</div>
<p>The source code for all exercises and typealongs will then be in the
<code class="docutils literal notranslate"><span class="pre">content/code</span></code> folder.</p>
</section>
<section id="working-on-vega">
<h2>Working on Vega<a class="headerlink" href="#working-on-vega" title="Permalink to this heading"></a></h2>
<p>You should have received your username in the days leading up to the workshop.
If not, please let us know.</p>
<p>The latest official release of <a class="reference external" href="https://hipsycl.github.io">hipSYCL</a> and CMake are available as modules on
Vega:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>module<span class="w"> </span>load<span class="w"> </span>hipSYCL<span class="w"> </span>CMake
</pre></div>
</div>
<p>You can compile on the login node with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>syclcc<span class="w"> </span>-o<span class="w"> </span>sycl_vadd<span class="w"> </span>sycl_vadd.cpp<span class="w"> </span>-O3<span class="w"> </span>--hipsycl-targets<span class="o">=</span><span class="s2">&quot;omp;cuda:sm_80&quot;</span>
</pre></div>
</div>
<p>However, it will be more convenient to use the CMake scripts we provide with the
source files:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cmake<span class="w"> </span>-S.<span class="w"> </span>-Bbuild<span class="w"> </span>-DHIPSYCL_TARGETS<span class="o">=</span><span class="s2">&quot;omp;cuda:sm_80&quot;</span>
<span class="gp">$ </span>cmake<span class="w"> </span>--build<span class="w"> </span>build
</pre></div>
</div>
<p>You can also request an interactive job with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>srun<span class="w"> </span>--nodes<span class="o">=</span><span class="m">1</span><span class="w"> </span>--exclusive<span class="w"> </span>--partition<span class="o">=</span>gpu<span class="w"> </span>--time<span class="o">=</span><span class="m">01</span>:00:00<span class="w"> </span>--pty<span class="w"> </span>bash<span class="w"> </span>-i
</pre></div>
</div>
<p>where you ask for:</p>
<ul class="simple">
<li><p>1 node (<code class="docutils literal notranslate"><span class="pre">--nodes=1</span></code>) in the <a class="reference external" href="https://doc.vega.izum.si/architecture/#gpu-partition">GPU partition</a> (<code class="docutils literal notranslate"><span class="pre">--partition=gpu</span></code>) for exclusive use (<code class="docutils literal notranslate"><span class="pre">--exclusive</span></code>)</p></li>
<li><p>a 1-hour long allocation (<code class="docutils literal notranslate"><span class="pre">--time=01:00:00</span></code>)</p></li>
<li><p>a bash interactive prompt once the job starts (<code class="docutils literal notranslate"><span class="pre">--pty</span> <span class="pre">bash</span> <span class="pre">-i</span></code>)</p></li>
</ul>
<p>In general, it is preferable to queue the job using a submission script, like the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env bash</span>

<span class="c1">#SBATCH --partition=gpu</span>
<span class="c1">#SBATCH --job-name=test</span>
<span class="c1">#SBATCH --mem=4G</span>
<span class="c1">#SBATCH --reservation=sycl</span>
<span class="c1">#SBATCH --gres=gpu:1</span>
<span class="c1">#SBATCH --time=00-01:00:00</span>
<span class="c1">#SBATCH --output=test_out.log</span>
<span class="c1">#SBATCH --error=test_err.log</span>

<span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>errexit<span class="w">  </span><span class="c1"># Exit the script on any error</span>
<span class="nb">set</span><span class="w"> </span>-o<span class="w"> </span>nounset<span class="w">  </span><span class="c1"># Treat any unset variables as an error</span>

module<span class="w"> </span>--quiet<span class="w"> </span>purge<span class="w">  </span><span class="c1"># Reset the modules to the system default</span>
module<span class="w"> </span>load<span class="w"> </span>hipSYCL/0.9.1-gcccuda-2020b
module<span class="w"> </span>list

<span class="c1"># compile code</span>
syclcc<span class="w"> </span>-o<span class="w"> </span>sycl_vadd<span class="w"> </span>sycl_vadd.cpp<span class="w"> </span>-O3<span class="w"> </span>--hipsycl-targets<span class="o">=</span><span class="s2">&quot;cuda:sm_80&quot;</span>

<span class="c1"># run executable</span>
./sycl_vadd

<span class="c1"># we can also use CMake to build</span>
<span class="c1"># module load CMake/3.18.4-GCCcore-10.2.0</span>
<span class="c1"># cmake -S$SLURM_SUBMIT_DIR -Bbuild -DHIPSYCL_TARGETS=&quot;cuda:sm_80&quot;</span>
<span class="c1"># and we run from the build folder</span>
<span class="c1"># ./build/sycl_vadd</span>

<span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Roberto Di Remigio and individual contributors..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>